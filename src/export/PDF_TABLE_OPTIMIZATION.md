# PDF表格导出优化说明

## 优化内容

### 1. 字体大小优化
- **表头字体**：从 7-8 号增加到 9 号
- **表格数据字体**：从 6-7 号增加到 8 号
- 提升了可读性，特别是对于中文内容

### 2. 行高优化
- **表头行高**：从 6-7mm 增加到 8mm
- **数据行高**：从 5-6mm 增加到 7mm
- 增加了行间距，表格不再拥挤

### 3. 列宽优化
- **最大列数**：从 6 列减少到 5 列
- 每列宽度增加约 20%
- 文字有更多空间显示，减少截断

### 4. 动态文本截断
- 根据列宽动态计算最大字符数
- 公式：`maxLen = int(colWidth / 2.5)`
- 更智能地适应不同列数的表格

### 5. 间距优化
- 标题后间距：从 8mm 增加到 10mm
- 表格后间距：从 4mm 增加到 5mm
- 整体排版更加舒适

## 影响范围

### 主要文件
1. `pdf_gopdf_service.go` - 主要PDF生成服务（推荐使用）
   - `addTable()` - 数据表格渲染
   - `renderInlineTable()` - 智能洞察中的内联表格

2. `pdf_service.go` - Maroto备用服务
   - `addTable()` - 数据表格渲染

### 表格类型
- ✅ 数据表格（从数据源导出）
- ✅ 智能洞察中的内联表格（json:table格式）

## 使用建议

### 最佳实践
1. **列数控制**：建议表格列数不超过 5 列
2. **数据量**：单个PDF最多显示 200 行数据（支持自动分页）
3. **字段名称**：表头文字建议控制在 15 个字符以内
4. **单元格内容**：根据列宽自动截断，无需手动处理

### 性能考虑
- 优化后的表格占用更多垂直空间
- 大数据集会生成更多页面
- 建议在导出前进行数据筛选和汇总

## 技术细节

### 字体支持
系统会按优先级尝试加载以下字体：
1. 微软雅黑 (msyh.ttc) - 推荐，现代美观
2. 微软雅黑粗体 (msyhbd.ttc)
3. 宋体 (simsun.ttc) - 经典
4. 黑体 (simhei.ttf)
5. Arial Unicode MS (ARIALUNI.TTF)
6. Arial (arial.ttf) - 备用

### 分页处理
- 自动检测页面剩余空间
- 新页面自动重绘表头
- 底部边距：12mm

## 测试建议

### 测试场景
1. **少列宽表**：2-3 列，测试列宽是否充足
2. **多列窄表**：5 列，测试是否拥挤
3. **长文本**：测试截断是否合理
4. **中文内容**：测试字体大小是否清晰
5. **多页表格**：测试分页和表头重复

### 预期效果
- 表格清晰易读
- 行间距舒适
- 文字不拥挤
- 中文显示清晰
