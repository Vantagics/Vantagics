# 多语言国际化实施计划

## 项目概述

为 VantageData 实现完整的多语言本地化支持，覆盖前端界面和后端消息。

## 已完成的工作

### 1. 基础设施搭建 ✅

#### 后端 Go 国际化框架
- ✅ 创建 `src/i18n/` 包
- ✅ 实现 `Translator` 类和单例模式
- ✅ 支持线程安全的语言切换
- ✅ 实现参数化翻译功能
- ✅ 创建英文翻译文件 (`translations_en.go`)
- ✅ 创建中文翻译文件 (`translations_zh.go`)
- ✅ 实现与前端配置同步机制 (`sync.go`)

#### 前端 TypeScript 国际化扩展
- ✅ 现有 `i18n.ts` 已包含 1000+ 翻译键
- ✅ 创建额外翻译补充文件 (`i18n_additions.ts`)
- ✅ 支持参数化翻译
- ✅ 实现 `useLanguage` Hook

### 2. 文档和工具 ✅

- ✅ 创建后端国际化使用指南 (`src/i18n/README.md`)
- ✅ 创建迁移指南 (`doc/I18N_MIGRATION_GUIDE.md`)
- ✅ 创建实施计划 (本文档)
- ✅ 创建查找硬编码字符串的脚本
  - `tools/find_hardcoded_strings.sh` (Linux/Mac)
  - `tools/find_hardcoded_strings.bat` (Windows)

### 3. 翻译内容 ✅

#### 后端翻译 (150+ 条)
- ✅ 授权服务器消息 (30+ 条)
- ✅ 数据源操作消息 (15+ 条)
- ✅ 分析操作消息 (15+ 条)
- ✅ 文件操作消息 (10+ 条)
- ✅ 数据库操作消息 (12+ 条)
- ✅ Skills 管理消息 (10+ 条)
- ✅ Python 环境消息 (7+ 条)
- ✅ 配置消息 (5+ 条)
- ✅ 认证授权消息 (6+ 条)
- ✅ 通用消息 (12+ 条)
- ✅ 导出操作消息 (10+ 条)
- ✅ MCP 服务消息 (5+ 条)
- ✅ 搜索 API 消息 (4+ 条)
- ✅ 会话管理消息 (7+ 条)
- ✅ 表操作消息 (6+ 条)
- ✅ 仪表盘操作消息 (5+ 条)

#### 前端翻译补充 (100+ 条)
- ✅ MessageBubble 组件消息
- ✅ SkillsManagementPage 组件消息
- ✅ AddDataSourceModal 组件消息
- ✅ DraggableDashboard 组件消息
- ✅ DataSourceOptimizeModal 组件消息
- ✅ ContextPanel 组件消息
- ✅ ChatSidebar 组件消息
- ✅ PreferenceModal 组件消息
- ✅ ActivationModal 组件消息
- ✅ Chart 组件消息
- ✅ DataTable 组件消息
- ✅ SmartInsight 组件消息
- ✅ 通用操作消息
- ✅ 状态消息
- ✅ 时间相关消息
- ✅ 文件大小消息

## 待完成的工作

### 阶段 1: 代码迁移 (优先级: 高)

#### 1.1 后端代码迁移

**授权服务器** (`tools/license_server/main.go`)
- [ ] 替换所有硬编码的中文错误消息
- [ ] 替换 SMTP 相关消息
- [ ] 替换数据库操作消息
- [ ] 替换 API 响应消息
- [ ] 添加语言设置同步

**数据源服务** (`src/app*.go`)
- [ ] 替换数据源导入/导出消息
- [ ] 替换连接测试消息
- [ ] 替换优化相关消息

**分析引擎** (`src/agent/`)
- [ ] 替换分析执行消息
- [ ] 替换错误处理消息
- [ ] 替换结果解析消息

**导出服务** (`src/export/`)
- [ ] 替换 PDF 导出消息
- [ ] 替换 Excel 导出消息
- [ ] 替换 Word 导出消息
- [ ] 替换 PPT 导出消息

#### 1.2 前端代码迁移

**高优先级组件**
- [ ] ActivationModal.tsx - 激活相关消息
- [ ] PreferenceModal.tsx - 设置相关消息
- [ ] MessageBubble.tsx - 消息气泡
- [ ] ChatSidebar.tsx - 聊天侧边栏

**中优先级组件**
- [ ] DraggableDashboard.tsx - 仪表盘
- [ ] AddDataSourceModal.tsx - 添加数据源
- [ ] DataSourceOptimizeModal.tsx - 数据源优化
- [ ] ContextPanel.tsx - 数据浏览器

**低优先级组件**
- [ ] Chart.tsx - 图表组件
- [ ] DataTable.tsx - 数据表格
- [ ] SmartInsight.tsx - 智能洞察
- [ ] 其他辅助组件

### 阶段 2: 集成和测试 (优先级: 高)

#### 2.1 后端集成
- [ ] 在 `app.go` 中初始化 i18n
- [ ] 从配置加载语言设置
- [ ] 实现语言切换 API
- [ ] 确保所有 HTTP 响应使用翻译

#### 2.2 前端集成
- [ ] 合并 `i18n_additions.ts` 到 `i18n.ts`
- [ ] 更新所有组件使用 `useLanguage` Hook
- [ ] 确保语言切换实时生效
- [ ] 测试所有翻译键

#### 2.3 前后端同步
- [ ] 实现配置更改时的语言同步
- [ ] 确保错误消息前后端一致
- [ ] 测试语言切换流程

### 阶段 3: 质量保证 (优先级: 中)

#### 3.1 翻译质量
- [ ] 审查所有英文翻译
- [ ] 审查所有中文翻译
- [ ] 确保术语一致性
- [ ] 检查语法和拼写

#### 3.2 功能测试
- [ ] 测试英文界面所有功能
- [ ] 测试中文界面所有功能
- [ ] 测试语言切换功能
- [ ] 测试参数化消息
- [ ] 测试错误消息显示

#### 3.3 性能测试
- [ ] 测试翻译查找性能
- [ ] 测试内存使用
- [ ] 测试并发场景

### 阶段 4: 文档和培训 (优先级: 低)

#### 4.1 开发者文档
- [ ] 更新 API 文档
- [ ] 更新组件文档
- [ ] 添加国际化最佳实践
- [ ] 创建示例代码

#### 4.2 用户文档
- [ ] 更新用户手册
- [ ] 添加语言切换说明
- [ ] 创建多语言截图

#### 4.3 团队培训
- [ ] 培训开发团队使用 i18n
- [ ] 培训测试团队测试多语言
- [ ] 培训翻译团队管理翻译

## 实施时间表

### 第 1 周: 后端迁移
- Day 1-2: 授权服务器迁移
- Day 3-4: 数据源服务迁移
- Day 5: 分析引擎和导出服务迁移

### 第 2 周: 前端迁移
- Day 1-2: 高优先级组件迁移
- Day 3-4: 中优先级组件迁移
- Day 5: 低优先级组件迁移

### 第 3 周: 集成和测试
- Day 1-2: 前后端集成
- Day 3-4: 功能测试
- Day 5: 性能测试和修复

### 第 4 周: 质量保证和文档
- Day 1-2: 翻译质量审查
- Day 3-4: 文档更新
- Day 5: 最终测试和发布准备

## 风险和缓解措施

### 风险 1: 遗漏硬编码字符串
**缓解**: 使用自动化脚本定期扫描，代码审查时检查

### 风险 2: 翻译不准确或不一致
**缓解**: 建立术语表，由母语者审查翻译

### 风险 3: 性能影响
**缓解**: 使用缓存，预加载翻译，性能测试

### 风险 4: 破坏现有功能
**缓解**: 充分测试，渐进式迁移，保留回退机制

### 风险 5: 团队学习曲线
**缓解**: 提供详细文档，示例代码，培训支持

## 成功标准

1. ✅ 所有用户可见的字符串都已国际化
2. ✅ 支持英文和简体中文两种语言
3. ✅ 语言切换功能正常工作
4. ✅ 前后端语言设置同步
5. ✅ 翻译质量达到母语水平
6. ✅ 性能无明显下降
7. ✅ 所有测试通过
8. ✅ 文档完整且准确

## 维护计划

### 日常维护
- 新功能开发时同步添加翻译
- 定期审查翻译质量
- 收集用户反馈改进翻译

### 定期审查
- 每季度审查翻译完整性
- 每半年审查翻译质量
- 每年评估是否需要支持新语言

### 工具支持
- 维护自动化扫描脚本
- 更新翻译管理工具
- 改进开发者体验

## 附录

### A. 翻译键命名规范

**前端**: `category_action_detail`
- 示例: `datasource_import_success`

**后端**: `category.action`
- 示例: `datasource.import_success`

### B. 参数化格式

**前端**: `{0}`, `{1}`, `{2}`
```typescript
t('message_with_params', value1, value2)
```

**后端**: `%s`, `%d`, `%f`
```go
i18n.T("message.with.params", value1, value2)
```

### C. 常用翻译键

| 英文 | 中文 | 键名 |
|------|------|------|
| Success | 成功 | `general.success` |
| Failed | 失败 | `general.failed` |
| Loading | 加载中 | `general.loading` |
| Error | 错误 | `general.error` |
| Cancel | 取消 | `cancel` |
| Confirm | 确认 | `confirm` |
| Save | 保存 | `save` |
| Delete | 删除 | `delete` |

### D. 联系方式

- 技术负责人: [待填写]
- 翻译负责人: [待填写]
- 测试负责人: [待填写]

## 更新日志

- 2024-XX-XX: 创建实施计划
- 2024-XX-XX: 完成基础设施搭建
- 2024-XX-XX: 开始代码迁移
