# VantageData 产品功能与使用方法详细说明

> 本文档面向客户支持系统，详细描述 VantageData 的所有产品功能、使用方法和操作流程，供客服人员参考。

---

## 一、产品概述

VantageData 是一款基于人工智能的桌面数据分析平台。用户通过自然语言对话即可完成数据查询、分析和可视化，无需编写 SQL 或代码。产品采用 Go + Wails 2.0 + React + TypeScript + Tailwind CSS 技术栈，支持 Windows 10/11、macOS 10.15+ 和 Linux 操作系统。

### 系统要求

| 项目 | 要求 |
|------|------|
| 操作系统 | Windows 10/11、macOS 10.15+、Linux |
| 内存 | 建议 8GB 以上 |
| 存储空间 | 至少 500MB 可用空间 |
| 屏幕分辨率 | 最低 1024×720，推荐 1366×768 以上 |
| 网络 | 需要网络连接以使用 AI 分析功能 |

---

## 二、授权模式与激活

VantageData 提供两种授权模式，用户首次启动时需选择其一。

### 2.1 商业模式（Commercial Mode）

- 使用序列号激活，激活后自动获取云端 LLM 服务配置，无需用户手动配置 API 密钥。
- 序列号格式为 `XXXX-XXXX-XXXX-XXXX`（16 位大写字母和数字）。
- 激活后 LLM 配置和搜索引擎配置由授权服务器集中下发，设置界面中相关配置项将被隐藏。
- 支持每日分析次数限制（由管理员设定）和有效期管理。

#### 激活步骤

1. 双击应用图标启动 VantageData。
2. 在首次启动的模式选择界面中，选择「商业模式」。
3. 输入序列号（格式：XXXX-XXXX-XXXX-XXXX）。
4. 点击「激活」按钮，系统自动连接授权服务器验证。
5. 激活成功后，LLM 服务自动配置完成，可直接开始使用。

#### 试用序列号申请

- 如果没有序列号，可点击「申请试用」链接。
- 输入邮箱地址，系统自动生成 30 天有效期的试用序列号。
- 同一邮箱只能申请一次；同一 IP 每天最多申请 5 次。

### 2.2 开源模式（Open Source Mode）

- 用户需自行配置 LLM API 密钥和端点。
- 支持多种 LLM 提供商（详见下文「AI 模型配置」章节）。
- 选择开源模式后，系统自动打开设置对话框的 LLM 配置页面，引导用户完成配置。

### 2.3 模式切换

用户可在「关于」对话框中随时切换授权模式：

- **商业模式 → 开源模式**：点击「切换到开源模式」→ 确认后清除授权数据 → 自动打开设置页面的 LLM 配置标签页。
- **开源模式 → 商业模式**：点击「切换到商业模式」→ 确认后弹出激活对话框 → 输入序列号激活。
- 注意：如果有分析任务正在进行中，系统会阻止切换并提示用户等待分析完成。

### 2.4 Credits 积分系统

商业模式下支持两种计费方式：

#### 每日限制模式（Daily Limit Mode）
- 每天有固定的分析次数上限（如 20 次/天）。
- 每日零点自动重置计数。
- 达到上限后提示「每日分析次数已达上限，请明天再试」。

#### 积分模式（Credits Mode）
- 一次性发放 Credits 积分，每次分析消耗 1.5 个 Credits。
- Credits 用完后无法继续分析，需联系管理员充值。
- 在「关于」对话框中可查看 Credits 使用情况，包括已用量、总量和进度条。
- Credits 用完时进度条显示为红色警告色。
- 客户端每小时自动向服务器上报 Credits 使用量，确保数据同步。

---

## 三、界面布局

VantageData 采用固定三面板布局，遵循从左到右的阅读习惯：

```
┌─────────────────────────────────────────────────────────────┐
│                        顶部菜单栏                            │
├──────────┬──────────────────────────────┬───────────────────┤
│          │                              │                   │
│  左侧面板 │         中央面板              │    右侧面板       │
│  (会话管理)│    (AI 对话 + 图表)          │   (仪表盘/数据)   │
│          │                              │                   │
│          ├──────────────────────────────┤                   │
│          │       消息输入框              │                   │
└──────────┴──────────────────────────────┴───────────────────┘
```

### 3.1 左侧面板

- **新建会话按钮**：位于面板顶部，点击创建新的分析会话。
- **历史会话列表**：按时间倒序显示所有历史分析会话，点击可恢复之前的分析上下文。
- 支持右键菜单操作：重命名、删除、导出会话。

### 3.2 中央面板（对话区域）

- 显示 AI 对话历史，包括用户提问和 AI 回复。
- AI 回复中自动嵌入可视化图表。
- 底部为消息输入框，用户在此输入分析问题。
- 分析进行中显示实时进度指示器。
- 支持取消正在进行的分析。

### 3.3 右侧面板（仪表盘/数据浏览器）

- 显示分析结果的仪表盘：指标卡片、图表、洞察摘要。
- 显示数据表格，支持分页浏览。
- 分析生成的文件提供下载链接。

### 3.4 数据浏览器（滑出面板）

- 通过数据源右键菜单的「浏览数据」选项打开。
- 从右侧滑入，覆盖中央面板区域，不影响左右面板。
- 显示数据源的表列表、列结构、数据类型和样本数据。
- 支持搜索/过滤表和列。
- 点击关闭按钮（X）或按 Escape 键关闭。

### 3.5 面板调整

- 面板之间有可拖拽的分隔条，用户可自由调整各面板宽度。
- 最小宽度约束：左侧 180px、中央 400px、右侧 280px。
- 面板宽度自动保存到本地存储，下次启动时恢复。

### 3.6 键盘快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+1 (Mac: Cmd+1) | 聚焦左侧面板 |
| Ctrl+2 (Mac: Cmd+2) | 聚焦中央面板 |
| Ctrl+3 (Mac: Cmd+3) | 聚焦右侧面板 |
| Ctrl+B (Mac: Cmd+B) | 切换数据浏览器显示/隐藏 |
| Escape | 关闭数据浏览器 |
| Tab | 面板内元素导航 |

---

## 四、数据源管理

VantageData 支持多种数据源类型，用户可通过「添加数据源」按钮接入数据。

### 4.1 本地文件导入

#### Excel 文件（.xlsx / .xls）
- 支持多工作表自动识别，每个工作表导入为独立数据表。
- 操作步骤：点击「添加数据源」→ 选择「Excel」→ 选择文件 → 输入数据源名称 → 点击「导入」。

#### CSV 文件
- 支持单文件导入或整个文件夹批量导入。
- 文件夹导入时，每个 CSV 文件导入为一个独立数据表。
- 操作步骤：点击「添加数据源」→ 选择「CSV」→ 选择文件或文件夹 → 输入名称 → 点击「导入」。

#### JSON 文件
- 支持结构化 JSON 数据导入。
- 操作步骤：点击「添加数据源」→ 选择「JSON」→ 选择文件 → 输入名称 → 点击「导入」。

### 4.2 数据库连接

#### MySQL
- 填写主机地址、端口（默认 3306）、用户名、密码、数据库名。
- 支持测试连接功能，确认配置正确后再导入。

#### PostgreSQL
- 填写主机地址、端口（默认 5432）、用户名、密码、数据库名。
- 支持测试连接。

#### SQLite
- 选择本地 SQLite 数据库文件路径。

#### Snowflake（企业级云数据仓库）
- 必填项：账户标识符（格式：account_name.region，如 xy12345.us-east-1）、用户名、密码。
- 可选项：Warehouse（计算资源仓库）、Database、Schema、Role。
- 数据导入后存储在本地 SQLite，可离线分析。
- 建议指定具体的 Database 和 Schema 以减少导入时间。

#### BigQuery（Google Cloud 数据仓库）
- 必填项：Google Cloud 项目 ID、服务账户 JSON 密钥内容。
- 可选项：数据集 ID（留空导入所有数据集）。
- 获取服务账户密钥步骤：
  1. 进入 Google Cloud Console。
  2. 导航到 IAM & Admin → Service Accounts。
  3. 创建服务账户，授予 BigQuery Data Viewer 和 BigQuery Job User 角色。
  4. 创建并下载 JSON 密钥文件。
  5. 将 JSON 内容粘贴到配置界面。

### 4.3 电商平台集成

#### Shopify
- **一键授权模式（推荐）**：输入店铺 URL → 点击「授权」→ 浏览器中完成 OAuth 授权 → 自动同步数据。
- **手动 Token 模式**：在 Shopify Admin 中创建自定义应用 → 配置 Admin API 权限（read_orders, read_products, read_customers）→ 复制 Access Token → 粘贴到 VantageData。
- 同步数据包括：订单、产品、客户信息。

#### BigCommerce
- 在 BigCommerce Admin 中创建 API 账户 → 设置 OAuth 权限（Products, Orders, Customers 只读）→ 复制 Store Hash 和 Access Token。
- 填写 Store Hash（从 API 路径中获取）和 Access Token。
- 同步数据包括：订单、产品、客户信息。

#### eBay
- 在 eBay Developer Program 中生成 OAuth User Token。
- 支持选择环境（Sandbox / Production）。
- 可选择导入的 API 类型：
  - Fulfillment API：订单、买家信息、支付。
  - Finances API：交易、费用、付款。
  - Analytics API：流量、转化率、卖家指标。

#### Etsy
- 在 Etsy Developer Portal 中生成 OAuth 2.0 Access Token。
- Shop ID 自动从 Token 中检测，无需手动输入。
- 同步数据包括：店铺信息、商品列表、订单、评价。

### 4.4 项目管理工具

#### Jira
- 支持 Jira Cloud 和 Jira Server / Data Center 两种实例类型。
- **Jira Cloud**：填写域名（如 your-domain.atlassian.net）、邮箱、API Token（从 Atlassian 账户设置 → 安全 → API tokens 生成）。
- **Jira Server**：填写服务器 URL、用户名、密码。
- 可选择导入特定项目或所有可访问项目。
- 支持「验证并获取项目」功能，先验证凭证再选择项目。
- 导入数据包括：Issues（问题）、Worklogs（工时）、Projects（项目）、Users（用户）、Sprints（冲刺），含自定义字段。

### 4.5 数据源操作

| 操作 | 方法 | 说明 |
|------|------|------|
| 重命名 | 右键数据源 → 重命名 | 修改数据源显示名称 |
| 删除 | 右键数据源 → 删除 | 永久删除数据源及其所有数据 |
| 浏览数据 | 右键数据源 → 浏览数据 | 打开数据浏览器查看表结构和数据 |
| 刷新 | 右键数据源 → 刷新 | 电商数据源支持增量刷新同步最新数据 |
| 删除表 | 在数据浏览器中操作 | 删除数据源中的特定表 |
| 重命名表/列 | 在数据浏览器中操作 | 修改表名或列名 |
| 删除列 | 在数据浏览器中操作 | 删除表中的特定列 |
| 导出到数据库 | 右键数据源 → 导出 | 将数据源导出到 MySQL 数据库 |
| 加载快捷分析包 | 右键数据源 → 加载快捷分析包 | 在该数据源上导入并执行快捷分析包 |

---

## 五、AI 智能分析

### 5.1 自然语言对话分析

VantageData 的核心功能是通过自然语言对话完成数据分析。用户只需在输入框中用日常语言描述分析需求，AI 自动完成以下工作：

1. **意图理解**：自动识别用户的分析意图（数据查询、可视化、导出、计算、咨询、网络搜索）。
2. **执行规划**：根据请求复杂度制定执行计划（简单/中等/复杂）。
3. **数据查询**：自动生成并执行 SQL 查询。
4. **数据处理**：通过 Python 代码进行数据清洗、转换和计算。
5. **图表生成**：根据数据特征自动选择合适的图表类型并生成可视化。
6. **结果呈现**：在对话区域展示分析结论、图表和数据表格。

#### 示例对话

```
用户：分析过去12个月的销售趋势
AI：[自动查询数据库 → 生成折线图 → 输出分析结论]
    根据数据分析，过去12个月销售额整体呈上升趋势，3月达到峰值...

用户：哪个产品销量最高？
AI：[查询产品销量数据 → 生成柱状图]
    产品A以1,234件的销量位居第一...

用户：按月统计订单数量并导出Excel
AI：[查询订单数据 → 生成统计表 → 导出Excel文件]
    已完成统计并导出，请下载文件...
```

### 5.2 多轮对话与上下文记忆

- 支持连续多轮对话，AI 自动维护对话上下文。
- 可以引用之前的分析结果进行追问，如「上面那个数据按地区拆分看看」。
- 记忆管理采用分层机制：
  - **短期记忆**：保留最近 5 条完整消息，用于即时推理。
  - **中期记忆**：较早的对话自动压缩为摘要，保留关键主题和发现。
  - **长期记忆**：持久化关键事实（数据源结构、业务规则、数据特征），跨会话复用。
- 用户可在菜单中查看当前 Agent 的记忆状态（短期/中期/长期）。

### 5.3 自动分析建议

- 创建新会话时，系统可自动生成分析建议（可在设置中开启/关闭）。
- 建议基于数据源的表结构和数据特征生成。
- 用户点击建议即可快速开始分析。

### 5.4 意图增强理解

- 可在设置中开启「自动意图理解」功能。
- 开启后，系统在执行分析前先理解和增强用户意图，提高分析准确性。
- 适用于表述模糊或复杂的分析请求。

### 5.5 分析进度与取消

- 分析过程中实时显示进度（当前阶段、进度百分比）。
- 进度阶段包括：获取数据结构 → 查询数据 → 分析处理 → 生成图表 → 完成。
- 用户可随时点击取消按钮中断分析。
- 分析完成时可播放声音提示（可在设置中开启/关闭）。

### 5.6 支持的 AI 模型

VantageData 支持以下 LLM 提供商，用户可在设置 → LLM 配置中选择和配置：

| 提供商 | 支持的模型 | 配置项 |
|--------|-----------|--------|
| OpenAI | GPT-4o、GPT-4、GPT-3.5 等 | API Key、Base URL（可选）、模型名称 |
| Anthropic (Claude) | Claude 3.5 Sonnet、Claude 3 Opus 等 | API Key、Base URL（可选）、Header Style |
| 通义千问 (Qwen) | Qwen 系列模型 | API Key、Base URL、模型名称 |
| 智谱 GLM | GLM-4 等 | API Key、Base URL、模型名称 |
| DeepSeek | DeepSeek 系列模型 | API Key、Base URL、模型名称 |
| MiniMax | MiniMax 系列模型 | API Key、Base URL、模型名称 |
| Google Gemini | Gemini Pro 等 | API Key、模型名称 |

#### LLM 配置步骤

1. 打开设置 → LLM 配置。
2. 选择提供商类型。
3. 填写 API Key。
4. （可选）填写自定义 Base URL（适用于代理服务、Ollama、LM Studio 等本地模型）。
5. 填写模型名称。
6. 设置最大 Token 数（默认 4096）。
7. 点击「测试连接」验证配置。
8. 点击「保存」。

#### Claude Header Style 说明

- 当使用 Claude 代理（如 AWS Bedrock、Vertex AI、One API）时，可选择 Header Style：
  - **Anthropic**（默认）：使用 x-api-key 头。
  - **OpenAI**：使用 Bearer Token（适用于某些 One API 配置）。

---

## 六、数据可视化

### 6.1 支持的图表类型

| 图表类型 | 适用场景 | 说明 |
|----------|---------|------|
| 折线图 | 趋势分析、时间序列 | 展示数据随时间的变化趋势 |
| 柱状图 | 分类对比、数量统计 | 对比不同类别的数值大小 |
| 饼图 | 占比分析、构成展示 | 展示各部分在整体中的比例 |
| 散点图 | 相关性分析、分布展示 | 展示两个变量之间的关系 |
| 热力图 | 密度分析、矩阵展示 | 用颜色深浅表示数值大小 |
| 组合图表 | 多维度综合展示 | 在同一图表中展示多种数据维度 |

### 6.2 图表交互功能

- **数据钻取**：点击图表中的数据点，深入查看详细数据。
- **动态筛选**：实时过滤和筛选图表数据。
- **图表导出**：将图表导出为图片格式。
- AI 根据数据特征自动选择最合适的图表类型，用户也可在对话中指定图表类型。

---

## 七、分析技能系统（Skills）

分析技能是预置的专业分析模板，可快速执行特定类型的分析任务，无需用户详细描述分析方法。

### 7.1 群组分析（Cohort Analysis）

- **分类**：用户分析（user_analytics）
- **功能**：
  - 按时间段（日/周/月）将用户分组为群组。
  - 计算各群组的留存率。
  - 生成留存热力图。
  - 识别高价值用户群组。
- **数据要求**：需要包含 user_id（用户标识）、event_date（事件日期）字段，event_type（事件类型）可选。
- **使用场景**：产品留存分析、用户生命周期价值评估、营销活动效果追踪、用户流失预警。
- **示例对话**：
  - 「分析用户留存率」
  - 「按月进行群组分析」
  - 「查看新用户的7日留存」
  - 「哪个群组的留存率最高」

### 7.2 销售漏斗分析（Sales Funnel）

- **分类**：销售分析（sales_analytics）
- **功能**：
  - 多阶段漏斗转化分析。
  - 转化率计算和可视化。
  - 流失点识别。
  - 转化时长分析。
  - 按渠道/来源分组分析。
- **数据要求**：需要 user_id、stage（漏斗阶段）、timestamp 字段，source（来源渠道）和 amount（交易金额）可选。
- **使用场景**：销售流程优化、转化率提升、营销 ROI 分析、渠道效果对比。
- **示例对话**：
  - 「分析销售漏斗转化率」
  - 「哪个阶段流失最严重」
  - 「不同渠道的转化效果对比」
  - 「从访问到购买的平均时长」

### 7.3 技能管理

- **启用/禁用**：在设置 → Skills 管理中切换技能状态。
- **安装自定义技能**：支持通过 ZIP 包安装第三方技能。
- **分析保护机制**：当有分析任务正在进行时，系统会阻止启用或禁用技能，防止影响正在执行的分析。此时会提示「当前有分析任务正在进行中，请等待分析完成后再试」。
- 查看技能列表和安装新技能不受分析状态限制。

---

## 八、快捷分析包（Quick Analysis Pack）

快捷分析包允许用户将一次完整的分析流程保存为可重放的包，在其他数据源上快速重现相同的分析。

### 8.1 导出快捷分析包

1. 在会话的上下文菜单中选择「导出快捷分析包」。
2. 在弹出的对话框中输入创作人名称。
3. （可选）设置口令密码对分析包进行加密保护。
4. 系统自动提取会话中所有已执行的 SQL 查询和 Python 代码，按执行顺序记录。
5. 同时记录原始数据源的完整 Schema 信息（表名、字段名、字段类型）。
6. 生成 .qap 文件（ZIP 格式封装的 JSON 数据）。

### 8.2 导入快捷分析包

1. 右键点击目标数据源 → 选择「加载快捷分析包」。
2. 在文件选择对话框中选择 .qap 文件。
3. 如果分析包设置了口令保护，需输入正确口令。
4. 系统自动验证目标数据源的 Schema 兼容性：
   - 检查所需的表是否存在。
   - 检查所需的字段是否存在。
   - 缺少必需的表会阻止导入；缺少字段会显示警告。
5. 确认导入后，系统创建专用的「快捷分析会话」。

### 8.3 快捷分析会话

- 快捷分析会话在会话列表中有特殊图标标识。
- 会话顶部显示包的元数据（创作人、创建时间、原始数据源名称）。
- 聊天输入框被禁用（不支持交互式对话）。
- 系统按顺序自动执行所有步骤，显示执行进度（当前步骤/总步骤数）。
- 某个步骤失败不会中断整体执行，会记录错误并继续后续步骤。
- 执行完成后在仪表盘中展示所有结果。
- 提供「重新执行」按钮，可重新运行所有步骤。

---

## 九、快捷分析包市场（Marketplace）

快捷分析包市场是一个在线社区平台，用户可以分享、浏览和下载他人创建的快捷分析包。

### 9.1 访问市场

- 通过系统菜单栏的「市场」菜单 → 「快捷包管理」进入。
- 快捷包管理界面列出本地所有已生成的快捷分析包。

### 9.2 用户登录

- 市场使用 SN + Email 自动登录，无需手动输入凭据。
- 当用户在 VantageData 客户端激活序列号后，访问市场功能时自动完成认证。
- 首次登录自动创建市场账户，并获得管理员配置的初始 Credits 余额。
- 认证流程：客户端 → License 服务器验证 SN+Email → 获取认证令牌 → Marketplace 服务器验证令牌 → 签发市场 JWT。

### 9.3 浏览和下载

- 市场按数据分类组织分析包，预设分类包括：Shopify、BigCommerce、eBay、Etsy。
- 管理员可创建自定义分类。
- 每个分析包显示：名称、描述、数据源名称、分类、作者、定价模式、价格、有效期/周期。
- **免费包**：直接下载，无使用限制。
- **按次付费包**：购买后获得指定次数的使用权，每次执行消耗一次，用完可追加购买。
- **限时包**：购买后在指定天数内无限次使用，到期后需重新购买。
- **订阅包**：按月/年订阅，到期前可续费。
- 下载完成后，.qap 文件保存到本地，收费包的使用权限信息也会保存到本地。
- 执行收费分析包前，系统会自动检查本地使用权限（剩余次数或有效期）。

### 9.4 分享分析包

1. 在快捷包列表中右键点击分析包 → 选择「分享到市场」。
2. 系统自动使用本地 SN + Email 完成登录（无需手动操作）。
3. 如果自动登录失败，显示错误提示和重试按钮。
4. 登录成功后显示分享设置对话框：
   - 选择分类。
   - 选择定价模式：
     - **免费**：无需设置价格。
     - **按次付费**：输入每次使用的 Credits 价格。
     - **限时**：输入 Credits 价格和有效天数。
     - **订阅**：输入 Credits 价格和计费周期（月付/年付）。
5. 确认后上传，显示上传进度。
6. 上传成功后分析包在市场中可见。

### 9.5 市场 Credits

- 每个市场用户有独立的 Credits 余额。
- 新用户注册时获得管理员配置的初始 Credits。
- 可通过支付方式购买 Credits。
- 购买收费分析包时自动扣除对应 Credits：
  - 按次付费：扣除一次使用的价格。
  - 限时：扣除完整价格，获得指定天数的使用权。
  - 订阅：扣除一个周期的价格（月付或年付）。
- 可查询 Credits 余额和交易历史。
- 支持追加购买（按次付费）和续费（订阅制）。

---

## 十、分析过程导出与导入

除了快捷分析包，VantageData 还支持更完整的分析过程导出/导入功能。

### 10.1 导出分析过程（.rbi 文件）

- 将完整的分析过程导出为 .rbi 文件（VantageData Analysis Export 格式）。
- 包含：数据源信息、Schema 要求、可执行步骤（SQL/Python）、原始结果。
- 格式版本为 2.0，支持步骤依赖关系和预期结果 Schema。

### 10.2 导入分析过程

- 通过文件选择对话框选择 .rbi 文件。
- 系统自动解析文件并验证 Schema 兼容性。
- 验证通过后可在目标数据源上重放分析。

### 10.3 分析记录与回放

- **分析记录器**：自动记录每一步分析操作（工具调用、输入输出、LLM 对话），保存为 JSON。
- **分析回放器**：在新数据源上回放已记录的分析，通过 Schema 兼容性分析和智能字段映射（LLM 辅助）适配新的表结构。
- **分析路径**：按「现象→行动→结论」模式记录分析故事线，支持自动报告生成。

---

## 十一、报告导出

VantageData 支持将分析结果导出为多种专业格式的报告。

### 11.1 单次分析结果导出

在分析结果的仪表盘中，点击导出按钮，选择格式：

| 格式 | 扩展名 | 特点 |
|------|--------|------|
| PDF | .pdf | 专业报告布局，支持中文字体，包含图表和表格 |
| Excel | .xlsx | 多工作表导出，自动列宽，表头样式美化 |
| PowerPoint | .pptx | 专业幻灯片布局，自动分页排版 |
| Word | .docx | 支持 Markdown 格式解析，结构化文档 |
| CSV | .csv | 通用数据交换格式，纯数据导出 |
| SQL | .sql | 数据库导出脚本 |
| JSON | .json | 结构化数据导出 |

### 11.2 综合报告生成

- 综合报告功能将整个会话的所有分析结果汇总为一份完整报告。
- 系统调用 LLM 生成报告文本，结合图表和数据表格。
- 报告内容缓存，避免重复生成。
- 支持导出为 PDF、Excel、PPT、Word 等格式。

### 11.3 导出到数据库

- 支持将数据源直接导出到 MySQL 数据库。
- 不能导出到与源相同的数据库。

### 11.4 导出文件命名

- 导出文件自动以「数据源名称_时间戳」格式命名。
- 用户可在保存对话框中修改文件名和保存位置。

---

## 十二、扩展功能

### 12.1 MCP 协议支持（Model Context Protocol）

- VantageData 支持连接外部 MCP 服务，扩展 AI Agent 的工具能力。
- 在设置 → MCP 服务中配置：
  - 服务名称和描述。
  - MCP 服务 URL。
  - 启用/禁用开关。
  - 连接测试功能。
- 配置的 MCP 服务工具会自动添加到 Agent 的可用工具列表中。

### 12.2 搜索 API 集成

VantageData 支持配置外部搜索 API，使 AI 能够进行网络搜索获取实时信息。

#### 支持的搜索 API

| 搜索 API | 说明 | API Key |
|----------|------|---------|
| DuckDuckGo | 免费搜索，无需 API Key | 不需要 |
| Serper.dev | Google 搜索结果 API | 需要 |
| UAPI Pro | 结构化数据搜索，目前免费测试中 | 可选 |

#### 配置步骤

1. 打开设置 → 搜索 API 配置。
2. 选择搜索 API 服务。
3. 填写 API Key（如需要）。
4. 点击「测试连接」验证。
5. 保存并设为活跃搜索 API。

### 12.3 UAPI 集成（结构化数据搜索）

- UAPI 提供标准化、结构化的数据搜索能力。
- 支持多种数据源类型：
  - **General（通用）**：网页内容、新闻、产品信息。
  - **Social（社交媒体）**：社交平台数据、趋势话题。
  - **Game（游戏）**：游戏统计、玩家数据、排行榜。
  - **Image（图片）**：图片搜索、媒体内容。
- 配置方式：设置 → 搜索 API → 选择 UAPI Pro → 填写 API Token → 测试连接 → 保存。
- 配置后 Agent 自动获得 `uapi_search` 工具，可在对话中使用。

### 12.4 网络搜索（Free Chat）

- 当用户提出非数据库相关的问题时，AI 可自动使用网络搜索获取信息。
- 支持的搜索引擎：Tavily、Serper、Bing。
- 搜索结果会被 AI 整合后呈现给用户。

---

## 十三、系统设置

### 13.1 LLM 配置

详见第五章「支持的 AI 模型」部分。

### 13.2 系统参数

| 参数 | 说明 | 默认值 |
|------|------|--------|
| 深色模式 | 启用深色界面主题 | 关闭 |
| 本地缓存 | 本地存储查询结果 | - |
| 详细日志 | 启用调试级别日志 | 关闭 |
| 声音提示 | 分析完成时播放提示音 | 开启 |
| 日志最大大小 | 日志文件压缩前的最大大小 | 100MB |
| 启用记忆 | 启用上下文记忆管理（可能影响简单查询速度） | - |
| 自动分析建议 | 新建会话时自动生成分析建议 | - |
| 自动意图理解 | 分析前自动增强理解用户意图 | - |
| 最大预览行数 | 数据预览窗口显示的行数 | 100 |
| 最大并发分析数 | 同时进行的分析任务上限（1-10） | 5 |
| 最大分析步骤数 | 每次分析的 Agent 推理步骤上限（10-50） | 25 |
| 数据缓存目录 | 应用数据存储目录 | ~/VantageData |
| 语言 | 界面语言（English / 简体中文） | 简体中文 |

### 13.3 Python 运行环境

VantageData 使用 Python 执行数据分析代码，需要配置 Python 环境：

- **自动创建环境**：点击「创建 VantageData 环境」，系统自动创建专用虚拟环境并安装所需包。
- **手动选择环境**：从检测到的 Python 环境列表中选择。
- **环境验证**：自动检查必需的 Python 包是否已安装（matplotlib、numpy、pandas、mlxtend、sqlite3）。
- **缺失包安装**：检测到缺失包时提供一键安装功能。
- **Python 诊断**：如遇环境问题，可运行「Python 安装诊断」获取详细报告。

### 13.4 代理服务器配置

- 支持 HTTP、HTTPS、SOCKS5 代理协议。
- 配置项：协议类型、主机地址、端口、用户名（可选）、密码（可选）。
- 支持测试连接验证代理可用性。

### 13.5 位置设置

- 设置用户所在国家/地区和城市。
- 用于天气查询、附近地点等位置相关功能。

### 13.6 电商 OAuth 配置（开发者设置）

- 配置 Shopify OAuth 凭证（Client ID 和 Client Secret），启用一键授权功能。
- 需要在 Shopify Partners 中注册应用并获取凭证。
- 设置 Redirect URL 为 `http://127.0.0.1:*/callback`。

### 13.7 日志管理

- 支持日志文件压缩和清理。
- 查看日志统计：总大小、日志文件数、归档文件数。
- 一键清理：压缩所有日志并移除旧归档。

---

## 十四、国际化（i18n）

### 14.1 支持的语言

- English（英文）
- 简体中文

### 14.2 语言切换

- 在设置 → 系统参数 → 语言中切换。
- 切换后立即生效，无需重启应用。
- 前端界面和后端服务消息全面本地化。

### 14.3 覆盖范围

- 所有菜单、按钮、标签、提示信息。
- 分析结果中的 AI 回复语言自动匹配用户设置。
- 错误消息和状态提示。
- 数据源配置引导文本。
- 报告导出内容。

---

## 十五、会话管理

### 15.1 创建新会话

- 点击左侧面板的「新建会话」按钮。
- 每个会话关联一个数据源，用于独立的分析任务。
- 会话名称默认为「分析：数据源名称」，可自定义。

### 15.2 历史会话

- 所有会话按时间倒序显示在左侧面板。
- 点击历史会话可恢复之前的对话上下文和分析结果。
- 切换会话时，右侧仪表盘自动更新为对应会话的结果。

### 15.3 会话操作

| 操作 | 方法 |
|------|------|
| 重命名 | 右键会话 → 重命名 |
| 删除 | 右键会话 → 删除 |
| 导出分析过程 | 右键会话 → 导出 |
| 导出快捷分析包 | 右键会话 → 导出快捷分析包 |
| 清除所有历史 | 点击「清除历史」按钮（不可撤销） |

### 15.4 查看结果目录

- 通过菜单可打开当前会话的结果文件目录。
- 目录中包含分析过程中生成的图表图片、导出文件等。

---

## 十六、安全与隐私

### 16.1 数据安全

- 所有数据存储在用户本地设备上。
- 导入的数据缓存在本地 SQLite 数据库中。
- 快捷分析包支持口令加密保护。

### 16.2 传输安全

- 商业模式下，授权配置使用 AES-256-GCM 加密传输。
- 授权服务器支持 HTTPS/SSL 配置。
- API 密钥仅保存在本地配置文件中。

### 16.3 授权安全

- 商业模式的配置信息仅保存在内存中，程序退出后清除。
- 序列号支持禁用/启用管理。
- 邮箱申请支持白名单/黑名单过滤。
- 支持 IP 级别的申请频率限制。

---

## 十七、常见问题（FAQ）

### Q1：首次启动应该选择哪种模式？

- 如果您有序列号或希望使用云端 LLM 服务，选择「商业模式」。
- 如果您有自己的 LLM API 密钥（如 OpenAI API Key），选择「开源模式」。
- 两种模式可随时切换。

### Q2：分析时提示「每日分析次数已达上限」怎么办？

- 商业模式下每日分析次数由管理员设定，每日零点自动重置。
- 等待次日重置，或联系管理员调整限制。

### Q3：分析时提示「Credits 不足」怎么办？

- Credits 模式下每次分析消耗 1.5 个 Credits。
- 联系管理员充值 Credits。

### Q4：如何更换 LLM 模型？

- 开源模式：设置 → LLM 配置 → 修改提供商和 API Key → 测试连接 → 保存。
- 商业模式：LLM 配置由服务器下发，用户无法自行修改。如需更换，联系管理员。

### Q5：导入数据源失败怎么办？

- 检查文件格式是否正确（Excel 需为 .xlsx/.xls，CSV 需为 UTF-8 编码）。
- 数据库连接失败时，检查主机地址、端口、用户名、密码是否正确。
- 电商平台连接失败时，检查 Access Token 是否有效、权限是否充足。
- Snowflake 连接失败时，检查账户标识符格式是否正确。

### Q6：分析结果不准确怎么办？

- 尝试更具体地描述分析需求。
- 开启「自动意图理解」功能提高准确性。
- 增加「最大分析步骤数」（设置 → 系统参数），给 AI 更多推理空间。
- 检查数据源中的数据质量（缺失值、异常值等）。

### Q7：如何在不同数据源上重复相同的分析？

- 使用「快捷分析包」功能：先在一个数据源上完成分析 → 导出为 .qap 文件 → 在其他数据源上导入执行。
- 或使用「分析过程导出」功能导出 .rbi 文件。

### Q8：Python 环境配置失败怎么办？

- 运行「Python 安装诊断」获取详细报告。
- 确保已安装 Python 3.3+ 或 Anaconda。
- 尝试使用「创建 VantageData 环境」自动创建专用环境。
- 如果自动创建失败，手动安装 Python 并确保添加到 PATH。

### Q9：如何使用网络搜索功能？

- 在设置中配置搜索 API（DuckDuckGo 免费可用，无需 API Key）。
- 在对话中直接提问非数据库相关的问题，AI 会自动使用网络搜索。

### Q10：快捷分析包的口令忘记了怎么办？

- 口令加密的分析包无法在不提供正确口令的情况下打开。
- 建议妥善保管口令，或重新从原始会话导出不加密的版本。

---

## 十八、技术支持

如遇到问题或有改进建议，请通过以下方式获取帮助：

- 查看应用内帮助文档。
- 访问官方文档网站。
- 联系技术支持团队。

---

*VantageData — 让数据分析更智能、更简单*
